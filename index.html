<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find your path to #Fitter #Stronger #Better | COACH CHRIS</title>
    
    <!-- --- SOCIAL SHARING METADATA --- -->
    <meta property="og:title" content="Find your path to #Fitter #Stronger #Better">
    <meta property="og:description" content="Take our short quiz to determine which service is best suited to help you achieve your goals">
    <meta property="og:image" content="https://placehold.co/1200x630/22c55e/000?text=COACH+CHRIS+Fitness+Assessment">
    <meta property="og:url" content="YOUR_APP_URL_HERE">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Find your path to #Fitter #Stronger #Better">
    <meta name="twitter:description" content="Take our short quiz to determine which service is best suited to help you achieve your goals">
    <meta name="twitter:image" content="https://placehold.co/1200x630/22c55e/000?text=COACH+CHRIS+Fitness+Assessment">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

        /* --- BACKGROUND & GLASSMORPHISM CORE --- */
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle at 20% 20%, #1a1a1a 0%, #000 100%);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background blobs for depth */
        body::before, body::after {
            content: "";
            position: fixed;
            width: 40vw;
            height: 40vw;
            border-radius: 50%;
            background: rgba(34, 197, 94, 0.15);
            filter: blur(100px);
            z-index: -1;
            animation: move 20s infinite alternate;
        }
        body::after {
            background: rgba(34, 197, 94, 0.1);
            right: -10%;
            top: 20%;
            animation-delay: -5s;
        }
        @keyframes move {
            from { transform: translate(-10%, -10%); }
            to { transform: translate(10%, 10%); }
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.125);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* --- LOADING SCREEN --- */
        #initial-loader {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease-out;
        }

        .cycling-text {
            font-family: monospace;
            color: #22c55e;
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-top: 1rem;
            min-height: 1.2em;
        }

        /* --- QUIZ SPECIFIC STYLES --- */
        .quiz-container {
            max-width: 650px;
            min-height: 550px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .option-button {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #fff;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .option-button:hover:not(.selected) {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(34, 197, 94, 0.5);
            transform: translateX(4px);
        }

        .selected {
            background: rgba(34, 197, 94, 0.2) !important;
            border-color: #22c55e !important;
            color: #fff !important;
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.2);
        }

        .action-button {
            background: #22c55e;
            color: #000;
            font-weight: 800;
            text-transform: uppercase;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }
        
        .action-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.6);
            filter: brightness(1.1);
        }
        
        .action-button:disabled {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.3);
            box-shadow: none;
            cursor: not-allowed;
        }
        
        .secondary-button {
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 600;
            transition: all 0.2s;
        }
        .secondary-button:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.1);
        }
        .progress-bar-fill {
            background: linear-gradient(90deg, #22c55e, #4ade80);
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-in {
            animation: slideUpFade 0.5s ease-out forwards;
        }

        @keyframes slideUpFade {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .custom-input {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            transition: all 0.2s;
        }
        .custom-input:focus {
            outline: none;
            border-color: #22c55e;
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.3);
        }
        
        input[type="checkbox"] {
            -webkit-appearance: none;
            appearance: none;
            width: 1.25rem; height: 1.25rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            cursor: pointer;
            position: relative;
        }
        input[type="checkbox"]:checked {
            background: #22c55e;
            border-color: #22c55e;
        }
        input[type="checkbox"]:checked::after {
            content: '✓';
            position: absolute;
            color: black;
            font-weight: bold;
            font-size: 0.8rem;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .clean-spinner {
            width: 50px; height: 50px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top: 3px solid #22c55e;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* Results specific glass styling */
        .result-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center p-4 sm:p-6">

    <!-- SPLASH SCREEN LOADER -->
    <div id="initial-loader">
        <div class="loader-content flex flex-col items-center">
            <h1 class="text-4xl font-black text-white uppercase tracking-tighter italic">COACHING QUIZ</h1>
            <div id="loader-pulse-text" class="text-green-500 font-bold text-xl uppercase tracking-widest mt-2">Loading...</div>
            <div id="loader-sub-text" class="cycling-text">Initializing assessment...</div>
        </div>
    </div>

    <!-- Main Quiz Container -->
    <div id="quiz-app" class="quiz-container glass-panel w-full rounded-3xl p-6 md:p-10 relative overflow-hidden">
        
        <!-- Decoration: Glowing Green line top -->
        <div class="absolute top-0 left-0 w-full h-1.5 bg-green-500 shadow-[0_0_15px_rgba(34,197,94,0.8)]"></div>

        <!-- BRANDING BLOCK -->
        <div class="mb-8 animate-in">
            <h1 class="text-3xl sm:text-4xl font-black text-white uppercase tracking-tighter leading-none">
                COACH CHRIS
            </h1>
            <div class="flex flex-wrap gap-x-4 gap-y-1 mt-2">
                <p class="text-xs font-bold uppercase text-neutral-400 tracking-widest">CIRCULAR ROOTS COACHING</p>
                <p class="text-xs font-bold uppercase text-green-500 tracking-widest">TRAIN UNCNVNTNL</p>
            </div>
        </div>

        <!-- Main Quiz Title -->
        <h2 class="text-2xl sm:text-3xl font-black text-white mb-6 uppercase italic tracking-tight leading-tight">
            FIND YOUR PATH TO BECOMING 
            <span class="text-green-500">#FITTER</span> 
            <span class="text-green-500">#STRONGER</span> 
            <span class="text-green-500">#BETTER</span>
        </h2>
        
        <!-- Progress Bar -->
        <div class="mb-10">
            <div class="flex items-center justify-between mb-2">
                <p id="progress-text-label" class="text-[10px] font-black uppercase tracking-[0.2em] text-neutral-400">
                    QUESTION 1 OF 11
                </p>
                <p id="progress-percent" class="text-[10px] font-black text-green-500 tracking-widest">
                    0%
                </p>
            </div>
            <div class="progress-container h-1.5 w-full rounded-full overflow-hidden">
                <div id="progress-bar-fill" class="progress-bar-fill h-full" style="width: 0%;"></div>
            </div>
        </div>

        <!-- Dynamic Content Area -->
        <div id="content-area">
            <div class="text-center font-bold animate-pulse text-neutral-500">LOADING...</div>
        </div>
    </div>
    
    <!-- Footer Block -->
    <div class="mt-12 w-full max-w-2xl text-center px-4">
        <p id="disclaimer" class="text-neutral-500 text-xs mb-6 leading-relaxed max-w-xl mx-auto">
            General Fitness Disclaimer: Always consult your medical professional or doctor before beginning any new fitness regime. This site provides general information for educational purposes only. You engage in physical activity at your own risk.
        </p>
        <p class="text-neutral-400 font-bold text-[10px] uppercase tracking-[0.25em]">
            © <span id="current-year">2025</span> COACH CHRIS | CIRCULAR ROOTS COACHING
        </p>
        <p class="text-green-500/50 text-sm italic font-semibold mt-2 tracking-widest">
            Fitter. Stronger. Better.
        </p>
    </div>


    <script>
        // Set dynamic year in footer
        document.getElementById('current-year').textContent = new Date().getFullYear();

        // Loading Screen Animation Logic
        window.addEventListener('load', () => {
            const loader = document.getElementById('initial-loader');
            const subText = document.getElementById('loader-sub-text');
            const cycleMessages = ["Loading questions...", "Configuring logic...", "Ready."];
            let i = 0;
            const cycleInterval = setInterval(() => {
                if (i < cycleMessages.length) { subText.textContent = cycleMessages[i++]; }
                else { clearInterval(cycleInterval); }
            }, 500);
            setTimeout(() => {
                loader.style.opacity = '0';
                setTimeout(() => { loader.style.display = 'none'; }, 500);
            }, 1800);
        });

        function markdownToHtml(text) {
            if (!text) return "";
            return text.replace(/\*\*(.*?)\*\*/g, '<strong class="text-white">$1</strong>')
                       .replace(/\*(.*?)\*/g, '<em class="text-neutral-300 font-medium">$1</em>');
        }

        const quizData = [
            { id: 1, question: "What is your #1 primary fitness goal right now?", key: "primaryGoal", options: [{ text: "Shedding fat and transforming my physique", score: 30 }, { text: "Getting strong and building solid muscle", score: 20 }, { text: "Boosting energy and improving my fitness/stamina", score: 10 }, { text: "Feeling generally healthier and more consistent", score: 5 }] },
            { id: 2, question: "How many days per week can you realistically commit?", key: "commitment", options: [{ text: "I'm ready for 5+ sessions per week (high commitment)", score: 30 }, { text: "I can commit 3-4 days a week easily", score: 20 }, { text: "1-2 days a week is realistic for me right now", score: 10 }, { text: "I need help finding consistency/just starting", score: 5 }] },
            { id: 3, question: "What is your biggest barrier to success?", key: "barrier", options: [{ text: "I don't have a plan that fits my goals", score: 5 }, { text: "I struggle with follow-through and need accountability", score: 20 }, { text: "My diet is my biggest weakness (need a strategy)", score: 30 }, { text: "Staying motivated and finding the time to train", score: 10 }] },
            { id: 4, question: "What level of support do you need?", key: "support", options: [{ text: "I need a great plan and I'll handle the rest", score: 5 }, { text: "I need weekly guidance and access to a coach", score: 20 }, { text: "Maximum accountability, check-ins, and a custom plan", score: 30 }, { text: "I learn best in a supportive group environment", score: 10 }] },
            { id: 5, question: "Do you have any injuries or medical considerations?", key: "medical", options: [{ text: "Yes, I have current injuries requiring specialized training", score: 30 }, { text: "I have minor aches but nothing that stops me from training", score: 20 }, { text: "No, I am generally fit and injury-free", score: 10 }, { text: "I'm not sure about my physical limitations yet", score: 5 }] },
            { id: 6, question: "What is your current level of commitment to investment?", key: "budget", options: [
                { text: "All-In: I need a coach to manage every detail for me (£175+)", score: 30, budgetId: 'PREMIUM' }, 
                { text: "Guided: I want a solid plan and someone to check my progress (£75)", score: 20, budgetId: 'MID' }, 
                { text: "Independent: I want the tools to do it myself (£45)", score: 10, budgetId: 'ENTRY' }, 
                { text: "Undecided: Show me what fits my needs first", score: 25, budgetId: 'FLEX' }
            ] },
            { id: 7, question: "Where do you primarily workout?", key: "location", options: [{ text: "A fully equipped gym/fitness center", score: 30 }, { text: "At home with minimal equipment", score: 10 }, { text: "Outdoors or using functional bodyweight training", score: 20 }, { text: "It varies (I travel or shift locations often)", score: 5 }] },
            { id: 8, question: "How would you describe your nutritional discipline?", key: "nutrition", options: [{ text: "I track macros/calories and just need refinement", score: 30 }, { text: "I eat generally healthy but need more structure", score: 20 }, { text: "My eating is inconsistent; I need a full overhaul", score: 10 }, { text: "I haven't focused on nutrition yet", score: 5 }] },
            { id: 9, question: "How crucial is guidance on daily habits and stress management?", key: "lifestyle", options: [{ text: "Essential (sleep and stress management are priorities)", score: 30 }, { text: "Important (I want it included in check-ins)", score: 20 }, { text: "Not crucial (I only need the workout programming)", score: 10 }, { text: "I am already highly disciplined in these areas", score: 5 }] },
            { id: 10, question: "What is your long-term health objective?", key: "longTerm", options: [{ text: "Maximize longevity and long-term vitality", score: 25 }, { text: "Improve aesthetics and physical appearance", score: 20 }, { text: "Perform at an elite level (sports/professional need)", score: 30 }, { text: "Maintain my current health and fitness level", score: 5 }] },
            { id: 11, question: "How would you describe your current training experience?", key: "experience", options: [
                { text: "I am brand new to structured training", score: 5, expId: 'BEGINNER' }, 
                { text: "I have some experience but lost my way", score: 15, expId: 'RETURNING' }, 
                { text: "I am an experienced trainee looking for an edge", score: 30, expId: 'EXPERIENCED' }
            ] }
        ];

        let currentStep = 0, totalScore = 0, selectedOption = null, userAnswers = [], clientName = "Warrior";

        const TIER_1_TITLE = "1-1 ONLINE COACHING";
        const TIER_2_TITLE = "FITTER STRONGER BETTER SUBSCRIPTION";
        const TIER_3_TITLE = "ONLINE PROGRAM LIBRARY";
        const FOUNDATIONS_TITLE = "14-DAY FUNDAMENTALS & 6-WEEK FOUNDATIONS";
        
        function getProgramDetailsByTitle(title) {
            if (title.includes(TIER_1_TITLE)) {
                return {
                    title: TIER_1_TITLE,
                    description: "Your goals require maximum accountability and highly specific programming. This is the premium, fully tailored solution designed to adapt to your lifestyle and ensure rapid, consistent progress.",
                    briefOverview: "Exclusive 1-on-1 coaching offering fully customized training and nutrition programming built specifically for you. Includes weekly in-depth check-ins, unlimited direct messaging with Coach Chris, and dynamic program adjustments.", 
                    accentColor: "text-green-400",
                    ctaLink: "https://coachchriscrc.github.io/oc-lp",
                    requiresCall: true,
                    priceId: 'PREMIUM'
                };
            } else if (title.includes(FOUNDATIONS_TITLE)) {
                return {
                    title: FOUNDATIONS_TITLE,
                    description: "You need a clear starting line. This pathway is designed specifically for those starting fresh or returning to training. We start with a free trial to build your confidence before moving into our structured group foundations.",
                    briefOverview: "Begin with our **Free 14-Day Fundamentals** trial to master the basics. This leads directly into our **6-Week Foundations Program (£99)**—a coach-guided online group experience that builds your absolute base for long-term health.",
                    accentColor: "text-orange-400",
                    ctaLink: "https://coachchriscrc.github.io/foundations-lp",
                    requiresCall: false,
                    priceId: 'ENTRY'
                };
            } else if (title.includes(TIER_2_TITLE)) {
                return {
                    title: TIER_2_TITLE,
                    description: "You have clear goals and a moderate level of commitment. This service provides structured programming, personalized check-ins, and a perfect blend of accountability and flexibility.",
                    briefOverview: "Access our Flagship Hybrid program (Strength, Endurance & Conditioning) via our dedicated app. This features custom nutrition targets, monthly progress check-ins with your coach, and ongoing community support.", 
                    accentColor: "text-blue-400",
                    ctaLink: "https://coachchriscrc.github.io/fsb-lp",
                    requiresCall: true,
                    priceId: 'MID'
                };
            } else {
                return {
                    title: TIER_3_TITLE,
                    description: "You are seeking expert-designed, foundational guidance. Gain instant access to professionally built, self-paced training plans you can execute on your own schedule.",
                    briefOverview: "Gain self-guided access to a library of diverse programs, including strength cycles, conditioning blocks, and WOD packs. Features full tutorials and movement demos—perfect for the independent trainee.", 
                    accentColor: "text-neutral-300",
                    ctaLink: "https://coachchriscrc.github.io/programs-lp",
                    requiresCall: false,
                    priceId: 'ENTRY'
                };
            }
        }
        
        function getRecommendation(score, answers) {
            const budgetId = answers.find(a => a.key === 'budget')?.budgetId || 'FLEX';
            const expId = answers.find(a => a.key === 'experience')?.expId || 'BEGINNER';
            
            // 1. High-Support Override: Budget £175+ always gets 1-1 Coaching
            if (budgetId === 'PREMIUM') {
                return getProgramDetailsByTitle(TIER_1_TITLE);
            } 
            
            // 2. Beginner/Returner Route
            if (expId === 'BEGINNER' || expId === 'RETURNING') {
                // If they chose Independent (£45), send them to the Library's self-guided beginner plans
                if (budgetId === 'ENTRY') {
                    return getProgramDetailsByTitle(TIER_3_TITLE);
                }
                // Otherwise, they get the guided Foundations path
                return getProgramDetailsByTitle(FOUNDATIONS_TITLE);
            }

            // 3. Experienced/Standard Route
            if (score >= 160 && budgetId !== 'ENTRY') {
                return getProgramDetailsByTitle(TIER_2_TITLE);
            }
            
            return getProgramDetailsByTitle(TIER_3_TITLE);
        }
        
        function getAlternativeRecommendation(primary, score, answers) {
            const budgetId = answers.find(a => a.key === 'budget')?.budgetId || 'FLEX';
            const expId = answers.find(a => a.key === 'experience')?.expId || 'BEGINNER';
            
            if (primary.title.includes(TIER_1_TITLE)) {
                if (expId === 'EXPERIENCED') return { ...getProgramDetailsByTitle(TIER_2_TITLE), type: 'DOWNGRADE' };
                return { ...getProgramDetailsByTitle(FOUNDATIONS_TITLE), type: 'DOWNGRADE' };
            } 
            
            if (primary.title.includes(FOUNDATIONS_TITLE)) {
                // If Foundations is primary, alternative is Library for independent approach
                return { ...getProgramDetailsByTitle(TIER_3_TITLE), type: 'DOWNGRADE' };
            }

            if (primary.title.includes(TIER_3_TITLE)) {
                // If Library is primary for a beginner, alternative is the Guided Foundations
                if (expId === 'BEGINNER' || expId === 'RETURNING') {
                    return { ...getProgramDetailsByTitle(FOUNDATIONS_TITLE), type: 'UPGRADE' };
                }
                return { ...getProgramDetailsByTitle(TIER_2_TITLE), type: 'UPGRADE' };
            }

            if (primary.priceId === 'MID') {
                if (score >= 210 || budgetId === 'FLEX') {
                    return { ...getProgramDetailsByTitle(TIER_1_TITLE), type: 'UPGRADE' };
                } else {
                    return { ...getProgramDetailsByTitle(TIER_3_TITLE), type: 'DOWNGRADE' };
                }
            } 
            
            return { ...getProgramDetailsByTitle(TIER_2_TITLE), type: 'UPGRADE' };
        }
        
        function generatePersonalizedRationale(answers, recommendationTitle) {
            const rawGoal = answers.find(a => a.key === 'primaryGoal')?.answer || 'an ambitious fitness goal';
            const rawBarrier = answers.find(a => a.key === 'barrier')?.answer || 'a specific obstacle';
            const budgetId = answers.find(a => a.key === 'budget')?.budgetId || 'FLEX';
            const expId = answers.find(a => a.key === 'experience')?.expId || 'BEGINNER';
            
            let goalPhrase = rawGoal;
            if (rawGoal.includes("Shedding fat")) goalPhrase = "fat loss and physique transformation";
            else if (rawGoal.includes("Getting strong")) goalPhrase = "building muscle and strength";
            else if (rawGoal.includes("Boosting energy")) goalPhrase = "improved energy and endurance";
            else if (rawGoal.includes("Feeling generally healthier")) goalPhrase = "establishing consistent habits";

            let barrierPhrase = rawBarrier;
            if (rawBarrier.includes("don't have a plan")) barrierPhrase = "lack of structure";
            else if (rawBarrier.includes("struggle with follow-through")) barrierPhrase = "need for external accountability";
            else if (rawBarrier.includes("My diet is my biggest weakness")) barrierPhrase = "optimizing nutrition";
            else if (rawBarrier.includes("Staying motivated")) barrierPhrase = "managing training time";

            let expText = "";
            if (expId === 'BEGINNER') expText = "As you are <span class='text-green-400'>brand new to structured training</span>, building a safe and competent base is our first priority. ";
            else if (expId === 'RETURNING') expText = "Since you are <span class='text-green-400'>returning after a break</span>, it's vital to re-establish your fundamentals before pushing high-intensity limits. ";
            else expText = "As an <span class='text-green-400'>experienced trainee looking for an edge</span>, your plan focuses on high-level programming to bypass your current plateau. ";

            let feature = '';
            if (recommendationTitle.includes(TIER_1_TITLE)) feature = 'maximum 1-on-1 personalization';
            else if (recommendationTitle.includes(FOUNDATIONS_TITLE)) feature = 'a risk-free trial and group guidance';
            else if (recommendationTitle.includes(TIER_2_TITLE)) feature = 'structured programming and coach check-ins';
            else if (expId === 'BEGINNER' || expId === 'RETURNING') feature = 'self-paced beginner plans';
            else feature = 'expert-designed training plans';

            let rationale = `${expText}We recognize <span class="text-green-400 font-bold">${goalPhrase}</span> as your priority. However, your progress is currently hindered by <span class="text-green-400 font-bold">${barrierPhrase}</span>. `;
            
            if (budgetId !== 'FLEX') {
                rationale += `Working within your <span class="text-white font-bold">preferred commitment level</span>, the <strong>${recommendationTitle}</strong> path is the most effective way to access <span class="text-white font-bold">${feature}</span> without over-extending, keeping your focus on sustainable results.`;
            } else {
                rationale += `The <strong>${recommendationTitle}</strong> path provides <span class="text-white font-bold">${feature}</span> to ensure you bypass these hurdles and see real progress.`;
            }

            return rationale;
        }

        function generateAlternativeDescription(primaryRec, altRec, answers) {
            if (!altRec) return "";
            const expId = answers.find(a => a.key === 'experience')?.expId || 'BEGINNER';
            let d = '';
            
            if (altRec.type === 'UPGRADE') {
                if (altRec.priceId === 'PREMIUM') {
                    d = `For **maximum accountability** and total personalization, consider stepping up to **1-1 Coaching**. This is the ultimate fast-track for your specific hurdles.`;
                } else if (altRec.title.includes(FOUNDATIONS_TITLE)) {
                    d = `If you prefer **guided coach support** and a risk-free trial, consider the **Foundations** path instead of self-guided training.`;
                } else {
                    d = `Once you've mastered the fundamentals, the **FSB Subscription** is the long-term home for hybrid strength and conditioning.`;
                }
            } else {
                if (altRec.priceId === 'ENTRY') {
                    if (altRec.title.includes(FOUNDATIONS_TITLE)) {
                        d = `For a more **guided entry** back into fitness, start with our **Free 14-Day Fundamentals**.`;
                    } else if (expId === 'BEGINNER' || expId === 'RETURNING') {
                        d = `If you prefer a **self-paced, independent approach**, the **Program Library** offers expert-built beginner plans without the live intakes.`;
                    } else {
                        d = `If you prefer a more **budget-conscious, self-guided approach**, the **Program Library** provides our expert training plans at a lower monthly investment.`;
                    }
                } else {
                    d = `The **FSB Subscription** offers a balance of coach access and structure without the full premium investment of 1-1 coaching.`;
                }
            }
            
            return markdownToHtml(d);
        }

        const contentArea = document.getElementById('content-area');
        const progressBarFill = document.getElementById('progress-bar-fill');
        const progressTextLabel = document.getElementById('progress-text-label'); 
        const progressPercent = document.getElementById('progress-percent'); 

        function updateProgress() {
            const total = quizData.length;
            const displayStep = currentStep === total ? total : currentStep + 1;
            const progress = (currentStep / total) * 100;
            progressBarFill.style.width = `${progress}%`;
            progressPercent.textContent = `${Math.round(progress)}%`;
            if (currentStep < total) progressTextLabel.textContent = `QUESTION ${displayStep} OF ${total}`;
            else progressTextLabel.textContent = `QUIZ COMPLETE`;
        }

        function renderQuestion() {
            if (currentStep >= quizData.length) { renderNameInputScreen(); return; }
            const stepData = quizData[currentStep];
            const prev = userAnswers.find(a => a.key === stepData.key);
            selectedOption = prev ? stepData.options.find(opt => opt.text === prev.answer) : null;
            contentArea.innerHTML = ''; 
            const nextText = currentStep === quizData.length - 1 ? 'SUBMIT' : 'CONTINUE';

            const div = document.createElement('div');
            div.className = 'animate-in';
            div.innerHTML = `
                <h2 class="text-xl sm:text-2xl font-bold text-white leading-snug mb-8">${stepData.question}</h2>
                <div id="options-container" class="space-y-3"></div>
                <div class="flex space-x-4 mt-12">
                    <button id="back-button" class="secondary-button w-1/3 p-4 text-sm uppercase tracking-widest rounded-2xl">BACK</button>
                    <button id="next-button" ${selectedOption ? '' : 'disabled'} class="action-button flex-grow p-4 text-sm uppercase tracking-widest rounded-2xl">${nextText}</button>
                </div>
            `;
            contentArea.appendChild(div);

            const container = document.getElementById('options-container');
            const nextBtn = document.getElementById('next-button');
            const backBtn = document.getElementById('back-button');
            if (currentStep === 0) backBtn.classList.add('invisible');
            else backBtn.addEventListener('click', handleBack);

            stepData.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.textContent = opt.text;
                btn.className = 'option-button w-full text-left p-5 rounded-2xl text-base';
                if (selectedOption && opt.text === selectedOption.text) btn.classList.add('selected');
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.option-button').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedOption = opt; nextBtn.disabled = false;
                });
                container.appendChild(btn);
            });
            nextBtn.addEventListener('click', handleNext);
            updateProgress();
        }
        
        function renderNameInputScreen() {
             currentStep = quizData.length; updateProgress();
             contentArea.innerHTML = `
                 <div class="text-center animate-in mb-8">
                     <div class="inline-block p-4 rounded-full border border-green-500/30 bg-green-500/10 mb-6">
                         <svg class="h-8 w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"/>
                         </svg>
                     </div>
                     <h2 class="text-2xl sm:text-3xl font-black uppercase italic tracking-tighter text-white">Finalize Results</h2>
                 </div>
                 <div class="animate-in glass-panel p-6 rounded-3xl relative overflow-hidden">
                     <div class="absolute -top-10 -right-10 w-24 h-24 bg-green-500/10 blur-2xl"></div>
                     <p class="text-sm font-medium text-neutral-300 mb-6">Enter your first name and agree to the disclaimer to unlock your recommendation.</p>
                     <form id="personalization-form" class="space-y-6">
                         <div>
                             <label class="block text-[10px] font-black uppercase text-neutral-500 tracking-widest mb-2">First Name</label>
                             <input type="text" id="client-name-input" required class="custom-input block w-full p-4 rounded-xl" placeholder="E.G. JANE" value="${clientName === 'Warrior' ? '' : clientName}">
                         </div>
                         <div class="flex items-start">
                            <input type="checkbox" id="disclaimer-check" required class="mt-1">
                            <label for="disclaimer-check" class="ml-3 text-xs text-neutral-400 leading-snug">
                                I have read and agree to the <a href="#disclaimer" class="font-bold underline text-white">fitness disclaimer</a>.
                            </label>
                        </div>
                         <button type="submit" id="display-button" disabled class="action-button w-full py-5 rounded-2xl text-sm tracking-widest">VIEW ANALYSIS</button>
                     </form>
                 </div>
             `;
             document.getElementById('personalization-form').addEventListener('submit', handlePersonalize);
             const nameIn = document.getElementById('client-name-input');
             const check = document.getElementById('disclaimer-check');
             const btn = document.getElementById('display-button');
             const upd = () => btn.disabled = !(nameIn.value.trim().length > 0 && check.checked);
             nameIn.addEventListener('input', upd); check.addEventListener('change', upd); upd(); 
        }

        function renderLoadingScreen() {
             contentArea.innerHTML = `
                 <div class="text-center animate-in min-h-[350px] flex flex-col items-center justify-center">
                     <div class="clean-spinner mb-8"></div> 
                     <p class="text-2xl font-black uppercase italic tracking-tighter text-white animate-pulse">Analyzing Answers...</p>
                     <p class="text-xs text-neutral-500 tracking-widest mt-4">CALCULATING OPTIMAL PATH</p>
                 </div>
             `;
             setTimeout(() => { renderFinalProgramSummary(); window.scrollTo({top: 0, behavior: 'smooth'}); }, 2500);
        }

        function renderFinalProgramSummary() {
            progressTextLabel.textContent = `ANALYSIS COMPLETE`;
            const primary = getRecommendation(totalScore, userAnswers);
            const alt = getAlternativeRecommendation(primary, totalScore, userAnswers);
            const rationale = generatePersonalizedRationale(userAnswers, primary.title);
            const altDesc = alt ? generateAlternativeDescription(primary, alt, userAnswers) : null; 
            const client = clientName.toUpperCase();
            const altTag = alt.type === 'UPGRADE' ? 'Step Up For Better Results' : 'A More Affordable Alternative';
            
            let primaryBtnText = "GET THE FULL BREAKDOWN";
            if (primary.title.includes(FOUNDATIONS_TITLE)) primaryBtnText = "START FREE 14-DAY FUNDAMENTALS";

            let step2;
            if (primary.title.includes(TIER_1_TITLE)) step2 = `<li><span class="text-white font-bold">Step 2: Apply & Consult</span><span class="block text-neutral-400 text-sm mt-1">${markdownToHtml("Submit an application and **chat with Coach Chris on WhatsApp**.")}</span></li>`;
            else if (primary.title.includes(FOUNDATIONS_TITLE)) step2 = `<li><span class="text-white font-bold">Step 2: Secure Your Intake</span><span class="block text-neutral-400 text-sm mt-1">${markdownToHtml("Complete the free fundamentals and **secure your spot** in the next group intake.")}</span></li>`;
            else if (primary.title.includes(TIER_2_TITLE)) step2 = `<li><span class="text-white font-bold">Step 2: Gain Access</span><span class="block text-neutral-400 text-sm mt-1">${markdownToHtml("Submit a short application then **follow the steps** to gain app access.")}</span></li>`;
            else step2 = `<li><span class="text-white font-bold">Step 2: Start Training</span><span class="block text-neutral-400 text-sm mt-1">${markdownToHtml(`Gain immediate access to the training app.`)}</span></li>`;

            contentArea.innerHTML = `
                <div class="animate-in space-y-8">
                    <div class="text-center">
                        <p class="text-[10px] font-black uppercase text-green-500 tracking-[0.3em] mb-2">Recommendation for ${client}</p>
                        <h1 class="text-3xl font-black uppercase text-white italic leading-tight">Your Optimal Path</h1>
                    </div>

                    <div class="result-card p-6 rounded-3xl border-green-500/20 bg-green-500/[0.02]">
                        <p class="text-[10px] font-black text-neutral-500 uppercase tracking-widest mb-4">Best Fit Program</p>
                        <h2 class="text-2xl font-black uppercase ${primary.accentColor} mb-3 leading-tight">${primary.title}</h2>
                        <p class="text-neutral-300 text-sm leading-relaxed mb-6">${primary.briefOverview}</p>
                        <div class="p-4 bg-white/5 rounded-2xl border border-white/10 mb-6">
                            <p class="text-xs italic text-neutral-400 leading-relaxed">${rationale}</p>
                        </div>
                        <a href="${primary.ctaLink}" target="_blank" class="action-button w-full block py-5 rounded-2xl text-sm text-center no-underline tracking-widest">${primaryBtnText}</a>
                    </div>

                    ${alt ? `
                    <div class="result-card p-6 rounded-3xl">
                        <h3 class="text-xs font-black uppercase text-white mb-4 tracking-widest opacity-50">${altTag}</h3>
                        <div class="flex flex-col gap-4">
                            <div>
                                <span class="block text-lg font-bold ${alt.accentColor} leading-tight">${alt.title}</span>
                                <span class="block text-xs text-neutral-400 mt-2">${altDesc}</span>
                            </div>
                            <a href="${alt.ctaLink}" target="_blank" class="secondary-button py-3 px-5 text-xs rounded-xl text-center no-underline tracking-widest">VIEW DETAILS</a>
                        </div>
                    </div>
                    ` : ''}

                    <div class="space-y-6 pt-4 border-t border-white/10">
                        <h3 class="text-sm font-black uppercase text-white tracking-widest">Success Principles</h3>
                        <ul class="space-y-4 text-sm text-neutral-400">
                            <li class="flex gap-3"><span class="text-green-500 font-black">•</span> <span><strong class="text-white">Consistency Over Perfection:</strong> 5 solid sessions beat 1 "perfect" one.</span></li>
                            <li class="flex gap-3"><span class="text-green-500 font-black">•</span> <span><strong class="text-white">Health Screening:</strong> A Par-Q screening is mandatory inside the training app for all new clients.</span></li>
                        </ul>
                    </div>

                    <div class="space-y-6 pt-4 border-t border-white/10">
                        <h3 class="text-sm font-black uppercase text-white tracking-widest">Next Steps</h3>
                        <ol class="space-y-6">
                            <li class="flex gap-4">
                                <span class="bg-white/10 w-6 h-6 flex items-center justify-center rounded-full text-[10px] font-bold text-white shrink-0">1</span>
                                <div><span class="text-white font-bold">Learn more about ${primary.title}</span><span class="block text-neutral-400 text-sm mt-1">Review the full program details, pricing, and access options via the button above.</span></div>
                            </li>
                            <li class="flex gap-4">
                                <span class="bg-white/10 w-6 h-6 flex items-center justify-center rounded-full text-[10px] font-bold text-white shrink-0">2</span>
                                <div>${step2}</div>
                            </li>
                        </ol>
                    </div>

                    <div class="pt-6">
                        <button id="restart-button" class="secondary-button w-full py-4 rounded-2xl text-xs tracking-[0.2em] uppercase">RESTART QUIZ</button>
                    </div>
                    
                    <div class="text-right pt-4">
                        <p class="text-sm font-black text-white italic">— Coach Chris</p>
                        <p class="text-[9px] font-bold text-neutral-500 uppercase tracking-widest">CIRCULAR ROOTS COACHING</p>
                    </div>
                </div>
            `;
            document.getElementById('restart-button').addEventListener('click', restartQuiz);
        }

        function handleNext() {
            if (selectedOption !== null) {
                const key = quizData[currentStep].key;
                const idx = userAnswers.findIndex(a => a.key === key);
                if (idx !== -1) { totalScore -= userAnswers[idx].score; userAnswers.splice(idx, 1); } 
                
                const answerObj = { 
                    key, 
                    question: quizData[currentStep].question, 
                    answer: selectedOption.text, 
                    score: selectedOption.score 
                };
                
                if (selectedOption.budgetId) answerObj.budgetId = selectedOption.budgetId;
                if (selectedOption.expId) answerObj.expId = selectedOption.expId;
                
                userAnswers.push(answerObj);
                totalScore += selectedOption.score; currentStep++;
                renderQuestion();
            }
        }
        
        function handleBack() { currentStep = Math.max(0, currentStep - 1); renderQuestion(); }
        
        function handlePersonalize(e) { e.preventDefault(); clientName = document.getElementById('client-name-input').value.trim().split(' ')[0]; renderLoadingScreen(); }
        
        function restartQuiz() { currentStep = 0; totalScore = 0; selectedOption = null; userAnswers = []; clientName = "Warrior"; renderQuestion(); }

        document.addEventListener('DOMContentLoaded', () => { updateProgress(); renderQuestion(); });
    </script>
</body>
</html>

